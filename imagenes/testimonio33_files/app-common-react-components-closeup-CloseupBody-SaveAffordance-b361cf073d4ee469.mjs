"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[53970],{975216:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var a=n(667294),i=n(545007),r=n(883119),l=n(587114),s=n(224796),o=n(510989),c=n(619370),d=n(172203),_=n(140017),u=n(906623);function p({constraint:e}){let t=(0,u.E)(),n=t?.getId();return(0,a.useEffect)(()=>{t&&t.markConstraintComplete(e)},[n,e]),null}var m=n(608516),f=n(731714),v=n(623409),h=n(494125),S=n(855142),y=n(559510),E=n(325945),g=n(623281),k=n(832853),b=n(785893);let Z=(0,k.Z)(()=>n.e(43473).then(n.bind(n,316503)),void 0,"PinSaveButtonCommon"),A=(0,a.lazy)(async()=>({default:(await Promise.all([n.e(69965),n.e(22538)]).then(n.bind(n,758697))).QuickSaveButtonWithExperienceAnchor})),C=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:n,onBoardSelectionFlyoutChange:k,onClickCallback:C,pin:I,showEnabledSaveBehavior:R,showRepinOnInitialRender:x,variant:P,viewParameter:T,viewType:U})=>{let w=(0,u.E)(),{experience:D}=(0,d.Z)(1000310),{experience:N}=(0,d.Z)(12),O=(0,v.Z)(),j=(0,i.I0)(),B=(0,_.ZP)(),L=(0,a.useRef)(!1),{pins:M,clear:K}=(0,y.Z)(),Q=f.Z.getItem(s.M8)||"",z=Q?Q===I.id:!!M&&M.length>0&&M[M.length-1].id===I.id;(0,h.Z)(()=>{L.current||2!==M.length&&(1!==M.length||z)||(L.current=!0,(2===M.length&&!Q&&z?[M[0]]:M).forEach(({id:e,nodeId:t})=>{(0,l.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},B).then(n=>{let{id:a,url:i,name:r}=n;j((0,E.d)({boardId:a,url:i,title:r||"",pinId:e||"",nodeId:t}))})}),z||K())});let G=()=>{f.Z.removeItem(s.M8),f.Z.removeItem(s.zz),K(),O({action:"trigger",item:"unauth-save-button-quicksave"}),j((0,g.hT)(!0)),j((0,E.d)({boardId:"",url:"",title:"Profile",pinId:I.id,nodeId:I?.node_id})),j((0,E.X)(I))},H=()=>{w&&w.markConstraintComplete("button")};if(I?.pinner?.blocked_by_me||I?.promoted_is_removable)return(0,b.jsx)(p,{constraint:"button"});if(D&&502450===D.experience_id)return(0,b.jsx)(o.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,b.jsx)(m.Z,{children:(0,b.jsx)(A,{autoQuicksaveCallback:G,clientTrackingParams:t,experience:D,onClickCallback:C,onMount:H,pinKey:{type:"deprecated",data:I},shouldAutoQuicksave:z,showEnabledSaveBehavior:R,viewParameter:T})})});let $=!I.content_sensitivity?.is_sensitive_content&&void 0!==e,V=[501041],W=N&&501041===N.experience_id&&N.display_data.has_tooltip?e=>(0,b.jsx)(c.default,{anchor:e,experienceIds:V,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):void 0;return $?(0,b.jsx)(r.xu,{children:(0,b.jsx)(o.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,b.jsx)(S.default,{autoQuicksaveCallback:G,clientTrackingParams:t,fromEggsBoard:n,onClickCallback:C,onMount:H,onToggleFlyout:k,pinKey:{type:"deprecated",data:I},renderPinSaveTooltip:W,shouldAutoQuicksave:z,variant:P,viewParameter:T,viewType:U})})}):(0,b.jsx)(o.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,b.jsx)(m.Z,{children:(0,b.jsx)(Z,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:C,onMount:H,pinKey:{type:"deprecated",data:I},renderPinSaveTooltip:W,showRepinOnInitialRender:x})})})}},235712:(e,t,n)=>{n.d(t,{i:()=>i,x:()=>r});var a=n(96452);let i=["shopping_rec_disabled","featureMap","comments_disabled","allow_mentions","messaging_permissions","opt_in_private_account","ads_customize_from_conversion","personalize_from_offsite_browsing","third_party_marketing_tracking_enabled","ccpa_opted_out","third_party_ads_personalization"];function r({apiErrorCode:e,onShowMessage:t,onPassCodeRequired:n,onPassCodeSkipConfirmation:i}){e&&(({[a.RR]:t,[a.mX]:n,[a.q6]:i})[e]||t)()}},876605:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(216167);let i=e=>a.Z.create("UserPasswordResource",e).callUpdate({showError:!1})},175789:(e,t,n)=>{n.d(t,{Z:()=>a});let a=(e,t)=>e.length>t?e.substr(0,t-3).trim()+"â€¦":e},647123:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(667294),i=n(191313);let r=e=>{if(!e)return null;try{return JSON.parse(e)}catch{return null}},l=new Set;function s(e){let t=(0,a.useCallback)(t=>{let n=n=>{n===e&&t()};return l.add(n),()=>{l.delete(n)}},[e]),n=(0,a.useSyncExternalStore)(t,()=>(0,i.qn)(e),()=>null),s=(0,a.useCallback)(t=>{null===t?(0,i.L_)(e):(0,i.Nh)(e,JSON.stringify(t)),l.forEach(t=>t(e))},[e]);return(0,a.useMemo)(()=>[r(n),s],[n,s])}},559510:(e,t,n)=>{n.d(t,{$:()=>i,Z:()=>s});var a=n(647123);let i=2,r=e=>e?.pins??[],l=e=>e.length?{pins:e}:null,s=()=>{let[e,t]=(0,a.Z)("unauthSavedPins"),n=r(e),s=e=>t(l(e)),o=()=>n.length<i;return{pins:n,save:e=>{o()&&s(n.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>s(n.filter(({id:t})=>t!==e)),isSaved:e=>n.some(({id:t})=>t===e),clear:()=>s([]),canSaveMore:o}}},623281:(e,t,n)=>{n.d(t,{Cp:()=>f,GT:()=>c,V6:()=>s,W2:()=>_,W6:()=>v,_L:()=>m,fm:()=>o,hT:()=>d});var a=n(216167),i=n(235712),r=n(876605),l=n(227258);function s(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}let o=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),c=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function d(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}let _=(e,t,n)=>a=>{a({type:"USER_SETTING_CHANGE",payload:{id:e,field:t,value:n}})},u=(e,t,n)=>a=>{a({type:"USER_PARTNER_SETTING_CHANGE",payload:{id:e,field:t,value:n}})},p=e=>{let t=e.split(" ");return{first_name:t[0],last_name:t[1]}},m=({field:e,value:t,passcode:n,onSettingSavedHn:r,showErrorHn:s,surfaceTag:o,userId:c,passcodeSkipAcknowledged:d=!1})=>async(m,f)=>{let v=f().users[c],h={user_id:c,surface_tag:o};if("full_name"===e){if(v.is_partner)h.business_name=t;else{let e=p(t);h.first_name=e.first_name,h.last_name=e.last_name||""}}else h[e]=t;n&&(h.passcode=n),i.i.includes(e)&&null!=d&&(h.user_confirm_skip_passcode=d);try{if(await a.Z.create("UserSettingsResource",h).callUpdate(),"profile_image_url"===e)m((0,l.b)("UserResource",{options:h}));else if("full_name"===e){if(v.is_partner)m(_(c,"first_name",t));else{let e=p(t);m(_(c,"first_name",e.first_name)),m(_(c,"last_name",e.last_name))}}m(v.is_partner&&("account_type"===e||"contact_name"===e)?u(c,e,t):_(c,e,t)),r()}catch(e){s(e)}},f=(e,t,n,a,i,l,s)=>()=>{(0,r.Z)({new:t,new_confirm:n,old:e,passcode:a,recaptcha_v3_token:i}).then(l,s)},v=(e,t,n,i,r,l)=>s=>{s(_(e,`${t}.${n}`,i));let o={},c="EmailSettingsResource";void 0!==r?(o={section:t,option:n,value:i,od:r.od,user_id:r.user_id},c="UnsubEmailSettingsResource"):o={section:t,option:n,value:i},a.Z.create(c,o).callUpdate().then(l).catch(()=>s(_(e,`${t}.${n}`,!i)))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/app-common-react-components-closeup-CloseupBody-SaveAffordance-b361cf073d4ee469.mjs.map